{"ast":null,"code":"import _regeneratorRuntime from\"/home/mmattox/go/src/github.com/mattmattox/opsdata/ui/opsdata-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/mmattox/go/src/github.com/mattmattox/opsdata/ui/opsdata-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/mmattox/go/src/github.com/mattmattox/opsdata/ui/opsdata-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Redirect}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(props){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),redirect=_useState6[0],setRedirect=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),failed=_useState8[0],setFailed=_useState8[1];var submit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var response,refreshPage,content;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:refreshPage=function _refreshPage(){window.location.reload(false);};e.preventDefault();_context.next=4;return fetch('http://localhost:8000/api/login',{method:'POST',headers:{'Content-Type':'application/json'},credentials:'include',body:JSON.stringify({email:email,password:password})});case 4:response=_context.sent;_context.next=7;return response.json();case 7:content=_context.sent;if(response.status===200){setRedirect(true);props.setName(content.name);refreshPage();}else{setFailed(true);setRedirect(false);}case 9:case\"end\":return _context.stop();}}},_callee);}));return function submit(_x){return _ref.apply(this,arguments);};}();var message;if(failed){message=/*#__PURE__*/_jsx(\"p\",{className:\"alert alert-danger\",style:{textAlign:\"center\"},children:\"Login failed, please try again\"});}else{message=/*#__PURE__*/_jsx(\"p\",{className:\"alert alert-primary\",style:{textAlign:\"center\"},children:\"Please sign in\"});}if(redirect){return/*#__PURE__*/_jsx(Redirect,{to:\"/\"});}return/*#__PURE__*/_jsxs(\"form\",{onSubmit:submit,children:[message,/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control\",placeholder:\"Email address\",required:true,onChange:function onChange(e){return setEmail(e.target.value);}}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",placeholder:\"Password\",required:true,onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"w-100 btn btn-lg btn-primary\",type:\"submit\",children:\"Sign in\"})]});};export default Login;","map":{"version":3,"sources":["/home/mmattox/go/src/github.com/mattmattox/opsdata/ui/opsdata-ui/src/pages/Login.tsx"],"names":["React","useState","Redirect","Login","props","email","setEmail","password","setPassword","redirect","setRedirect","failed","setFailed","submit","e","refreshPage","window","location","reload","preventDefault","fetch","method","headers","credentials","body","JSON","stringify","response","json","content","status","setName","name","message","textAlign","target","value"],"mappings":"kiBAAA,MAAOA,CAAAA,KAAP,EAA+BC,QAA/B,KAA8C,OAA9C,CACA,OAAQC,QAAR,KAAuB,kBAAvB,C,wFAEA,GAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACC,KAAD,CAA+C,CACzD,cAA0BH,QAAQ,CAAC,EAAD,CAAlC,wCAAOI,KAAP,eAAcC,QAAd,eACA,eAAgCL,QAAQ,CAAC,EAAD,CAAxC,yCAAOM,QAAP,eAAiBC,WAAjB,eACA,eAAgCP,QAAQ,CAAC,KAAD,CAAxC,yCAAOQ,QAAP,eAAiBC,WAAjB,eACA,eAA4BT,QAAQ,CAAC,KAAD,CAApC,yCAAOU,MAAP,eAAeC,SAAf,eAEA,GAAMC,CAAAA,MAAM,0FAAG,iBAAOC,CAAP,eAaFC,WAbE,yHAaFA,WAbE,wBAaY,CACrBC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuB,KAAvB,EACD,CAfU,CACXJ,CAAC,CAACK,cAAF,GADW,sBAGYC,CAAAA,KAAK,CAAC,iCAAD,CAAoC,CAC5DC,MAAM,CAAE,MADoD,CAE5DC,OAAO,CAAE,CAAC,eAAgB,kBAAjB,CAFmD,CAG5DC,WAAW,CAAE,SAH+C,CAI5DC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACjBrB,KAAK,CAALA,KADiB,CAEjBE,QAAQ,CAARA,QAFiB,CAAf,CAJsD,CAApC,CAHjB,QAGLoB,QAHK,qCAiBWA,CAAAA,QAAQ,CAACC,IAAT,EAjBX,QAiBLC,OAjBK,eAmBX,GAAGF,QAAQ,CAACG,MAAT,GAAoB,GAAvB,CAA2B,CACzBpB,WAAW,CAAC,IAAD,CAAX,CACAN,KAAK,CAAC2B,OAAN,CAAcF,OAAO,CAACG,IAAtB,EACAjB,WAAW,GACZ,CAJD,IAIK,CACHH,SAAS,CAAC,IAAD,CAAT,CACAF,WAAW,CAAC,KAAD,CAAX,CACD,CA1BU,sDAAH,kBAANG,CAAAA,MAAM,4CAAZ,CA6BA,GAAIoB,CAAAA,OAAJ,CAEA,GAAItB,MAAJ,CAAY,CACVsB,OAAO,cACL,UAAG,SAAS,CAAC,oBAAb,CAAkC,KAAK,CAAE,CAAEC,SAAS,CAAE,QAAb,CAAzC,4CADF,CAGD,CAJD,IAMA,CACED,OAAO,cACL,UAAG,SAAS,CAAC,qBAAb,CAAmC,KAAK,CAAE,CAAEC,SAAS,CAAE,QAAb,CAA1C,4BADF,CAGD,CACD,GAAIzB,QAAJ,CAAc,CACV,mBAAO,KAAC,QAAD,EAAU,EAAE,CAAC,GAAb,EAAP,CACH,CAED,mBACI,cAAM,QAAQ,CAAEI,MAAhB,WACKoB,OADL,cAGI,cAAO,IAAI,CAAC,OAAZ,CAAoB,SAAS,CAAC,cAA9B,CAA6C,WAAW,CAAC,eAAzD,CAAyE,QAAQ,KAAjF,CACO,QAAQ,CAAE,kBAAAnB,CAAC,QAAIR,CAAAA,QAAQ,CAACQ,CAAC,CAACqB,MAAF,CAASC,KAAV,CAAZ,EADlB,EAHJ,cAOI,cAAO,IAAI,CAAC,UAAZ,CAAuB,SAAS,CAAC,cAAjC,CAAgD,WAAW,CAAC,UAA5D,CAAuE,QAAQ,KAA/E,CACO,QAAQ,CAAE,kBAAAtB,CAAC,QAAIN,CAAAA,WAAW,CAACM,CAAC,CAACqB,MAAF,CAASC,KAAV,CAAf,EADlB,EAPJ,cAWI,eAAQ,SAAS,CAAC,8BAAlB,CAAiD,IAAI,CAAC,QAAtD,qBAXJ,GADJ,CAeH,CAnED,CAqEA,cAAejC,CAAAA,KAAf","sourcesContent":["import React, {SyntheticEvent, useState} from 'react';\nimport {Redirect} from \"react-router-dom\";\n\nconst Login = (props: { setName: (name: string) => void}) => {\n    const [email, setEmail] = useState('');\n    const [password, setPassword] = useState('');\n    const [redirect, setRedirect] = useState(false);\n    const [failed, setFailed] = useState(false);\n\n    const submit = async (e: SyntheticEvent) => {\n        e.preventDefault();\n\n        const response = await fetch('http://localhost:8000/api/login', {\n            method: 'POST',\n            headers: {'Content-Type': 'application/json'},\n            credentials: 'include',\n            body: JSON.stringify({\n                email,\n                password\n            })\n        });\n\n        function refreshPage() {\n          window.location.reload(false);\n        }\n\n        const content = await response.json();\n        \n        if(response.status === 200){\n          setRedirect(true);\n          props.setName(content.name);\n          refreshPage();\n        }else{\n          setFailed(true)\n          setRedirect(false);\n        }\n    }\n\n    let message;\n\n    if (failed) {\n      message = (\n        <p className=\"alert alert-danger\" style={{ textAlign: \"center\" }}>Login failed, please try again</p>\n      )\n    }\n    else\n    {\n      message = (\n        <p className=\"alert alert-primary\" style={{ textAlign: \"center\" }}>Please sign in</p>\n      )\n    }\n    if (redirect) {\n        return <Redirect to=\"/\"/>;\n    }\n\n    return (\n        <form onSubmit={submit}>\n            {message}\n            \n            <input type=\"email\" className=\"form-control\" placeholder=\"Email address\" required\n                   onChange={e => setEmail(e.target.value)}\n            />\n\n            <input type=\"password\" className=\"form-control\" placeholder=\"Password\" required\n                   onChange={e => setPassword(e.target.value)}\n            />\n\n            <button className=\"w-100 btn btn-lg btn-primary\" type=\"submit\">Sign in</button>\n        </form>\n    );\n};\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}